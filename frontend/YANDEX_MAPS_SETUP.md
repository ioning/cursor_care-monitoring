# Настройка Яндекс карт

## Получение API ключа

1. Перейдите на [Яндекс.Кабинет разработчика](https://developer.tech.yandex.ru/)
2. Создайте новый проект или выберите существующий
3. Перейдите в раздел "JavaScript API и HTTP Геокодер"
4. Создайте новый ключ API
5. Скопируйте полученный ключ

## Настройка в приложениях

### Приложение диспетчера

Откройте файл `frontend/apps/dispatcher-app/src/components/WardsLocationMap.vue` и замените `YOUR_API_KEY` на ваш API ключ:

```typescript
script.src = 'https://api-maps.yandex.ru/2.1/?apikey=ВАШ_API_КЛЮЧ&lang=ru_RU';
```

### Приложение опекуна

Откройте файл `frontend/apps/guardian-app/src/components/WardLocationMap.vue` и замените `YOUR_API_KEY` на ваш API ключ:

```typescript
script.src = 'https://api-maps.yandex.ru/2.1/?apikey=ВАШ_API_КЛЮЧ&lang=ru_RU';
```

## Альтернативный способ: использование переменных окружения

Для более безопасного хранения API ключа можно использовать переменные окружения:

1. Создайте файл `.env` в корне каждого приложения:
   - `frontend/apps/dispatcher-app/.env`
   - `frontend/apps/guardian-app/.env`

2. Добавьте в файл:
   ```
   VITE_YANDEX_MAPS_API_KEY=ваш_api_ключ
   ```

3. Обновите код загрузки скрипта:
   ```typescript
   const apiKey = import.meta.env.VITE_YANDEX_MAPS_API_KEY || 'YOUR_API_KEY';
   script.src = `https://api-maps.yandex.ru/2.1/?apikey=${apiKey}&lang=ru_RU`;
   ```

## Установка зависимостей

Яндекс карты загружаются через script тег, поэтому дополнительных npm пакетов не требуется. Просто убедитесь, что все остальные зависимости установлены:

```bash
cd frontend/apps/dispatcher-app
npm install

cd ../guardian-app
npm install
```

## Функциональность

### Приложение диспетчера (WardsLocationMap)

- Отображение всех подопечных на карте
- Маркеры с цветовой индикацией по приоритету вызовов
- Автоматическое обновление местоположения
- Отслеживание всех подопечных одновременно
- Список подопечных с информацией о местоположении

### Приложение опекуна (WardLocationMap)

- Отображение текущего местоположения подопечного
- Отслеживание в реальном времени (обновление каждые 10 секунд)
- История перемещений с отображением пути
- Геозоны (безопасные и запрещенные зоны)
- Информация о точности и источнике данных

## Ограничения API

Бесплатный тариф Яндекс карт включает:
- До 25,000 запросов в день
- До 500,000 запросов в месяц

Для продакшена рекомендуется:
- Использовать кэширование геокодинга
- Ограничить частоту обновления местоположения
- Использовать серверный геокодинг для уменьшения запросов

