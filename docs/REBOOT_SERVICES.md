# ⚠️ ВАЖНО: Перезапуск сервисов после изменений доступа

После изменений в проверке доступа необходимо **перезапустить** следующие сервисы:

## Сервисы, которые нужно перезапустить:

1. **telemetry-service** (порт 3004)
2. **location-service** (порт 3005)
3. **user-service** (порт 3002) - для обновленной проверки доступа

## Как перезапустить:

### Вариант 1: Остановить и запустить заново

```bash
# Остановить все сервисы (Ctrl+C в терминалах где они запущены)
# Затем запустить заново:

npm run dev:telemetry
npm run dev:location
npm run dev:user
```

### Вариант 2: Если используете npm run dev:services

```bash
# Остановить все сервисы (Ctrl+C)
# Затем запустить все заново:

npm run dev:services
```

## Проверка что изменения применены:

После перезапуска проверьте логи сервисов - вы должны увидеть сообщения о доступе:
- `Access granted for admin ...` 
- `Access granted for dispatcher ...`
- `Access check for guardian ...: true/false`

## Что было исправлено:

1. **Admin** и **Dispatcher** теперь имеют полный доступ ко всем данным подопечных
2. **Guardian** проверяется через таблицу `guardian_wards` с учетом статуса `active`
3. Добавлено логирование для отладки проверки доступа

## Если ошибки 403 продолжаются:

1. Убедитесь, что сервисы действительно перезапущены
2. Проверьте логи сервисов на наличие ошибок
3. Убедитесь, что JWT токен содержит поле `role`
4. Проверьте, что связь опекун-подопечный существует в БД (статус `active`)

