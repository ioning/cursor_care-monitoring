# Design: Admin App

## Технологический стек

Код: `frontend/apps/admin-app/` (Vue 3 + Vite + TypeScript)

**Основные технологии:**
- Vue 3 с Composition API
- TypeScript для типобезопасности
- Pinia для state management (`src/stores/*`)
- Vue Router для навигации
- ApexCharts для визуализаций
- WebSocket для realtime-обновлений (`src/services/realtime.service.ts`)
- API-клиенты: `src/api/*.ts`

## Дизайн-система

### Цветовая палитра

**Темная тема (Dark Mode):**
- Фон приложения: `#050912` (темно-синий, почти черный)
- Фон панелей: `rgba(12, 20, 35, 0.85)` с эффектом glass-panel
- Sidebar: `rgba(6, 10, 19, 0.95)` с blur-эффектом
- Акцентные градиенты: `linear-gradient(135deg, rgba(62, 137, 255, 0.25), rgba(140, 94, 255, 0.2))`
- Текст основной: `#e9eef5` (светло-серый)
- Текст вторичный: `rgba(255, 255, 255, 0.7)`
- Границы: `rgba(255, 255, 255, 0.05)` - `rgba(255, 255, 255, 0.06)`

### Типографика

- Шрифт: `'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif`
- Line-height: `1.4`
- Font-weight: `400` (основной), `600` (меню), `700` (заголовки)

### Визуальные эффекты

**Glass-panel (стеклянная панель):**
- `background: rgba(12, 20, 35, 0.85)`
- `backdrop-filter: blur(18px)`
- `border: 1px solid rgba(255, 255, 255, 0.05)`
- `border-radius: 16px`

**Анимации:**
- Плавные переходы: `transition: all 0.2s ease`
- Collapse sidebar: `transition: width 0.2s ease`

### Компоненты дизайн-системы

**Навигация:**
- Sidebar с возможностью сворачивания (240px → 96px)
- Активные пункты меню с градиентным фоном и свечением
- Breadcrumbs в top-bar
- Context Panel для быстрых действий

**Карточки и панели:**
- Glass-panel эффект для всех контейнеров
- Метрики в виде карточек с иконками
- Статусные бейджи (StatusBadge)
- Sparkline графики для трендов

**Таблицы:**
- Фильтруемые таблицы с сортировкой
- Массовые операции (BulkActionsBar)
- Матрица прав доступа (RoleMatrixDrawer)

## Структура экранов

### 1. Dashboard (Системный дашборд)

**Путь:** `/`

**Компоненты:**
- `SystemHealthOverview` — обзор здоровья системы (CPU, память, диск, сеть)
- `ServiceMap` — карта сервисов с зависимостями и статусами
- `CriticalAlerts` — критичные алерты с возможностью acknowledge
- `PerformanceTrends` — графики производительности

**Особенности:**
- Real-time обновления через WebSocket канал `system.health`
- Горячие клавиши: `Shift+H` — обновление дашборда, `Shift+E` — экспорт
- Адаптивная сетка: 3fr 2fr на больших экранах, 1fr на мобильных

### 2. Users (Управление пользователями)

**Путь:** `/users`

**Компоненты:**
- `UserTable` — таблица пользователей с фильтрацией и сортировкой
- `UserFilters` — расширенные фильтры (роль, организация, статус)
- `BulkActionsBar` — массовые операции (изменение ролей, блокировка)
- `RoleMatrixDrawer` — матрица прав доступа для ролей

**Функциональность:**
- Поиск по имени, email, организации
- Фильтрация по ролям (admin, guardian, dispatcher, ward)
- Массовое назначение/снятие ролей
- Просмотр и редактирование матрицы прав

### 3. Monitoring (Системный мониторинг)

**Путь:** `/monitoring`

**Компоненты:**
- `RealtimeMetrics` — метрики в реальном времени (RPS, latency, errors)
- `DatabaseInsights` — состояние БД (connections, queries, replication lag)
- `IntegrationStatus` — статус интеграций (SMP, внешние API)

**Особенности:**
- Live-обновления метрик через WebSocket
- Алерты при превышении пороговых значений
- История метрик с возможностью экспорта

### 4. Analytics (Аналитика и отчеты)

**Путь:** `/analytics`

**Компоненты:**
- `AnalyticsKPIs` — ключевые показатели (MRR, ARR, активные пользователи)
- `RevenueBreakdown` — разбивка доходов по тарифам и организациям
- `UsageInsights` — популярность функций, паттерны использования

**Визуализация:**
- Графики ApexCharts (линейные, столбчатые, круговые)
- Сравнение периодов (месяц к месяцу, год к году)
- Фильтры по датам и организациям
- Экспорт отчетов в CSV/PDF

### 5. AI Models (AI модели)

**Путь:** `/ai-models`

**Функциональность:**
- Регистрация новых моделей (название, версия, endpoint)
- Управление версиями моделей
- Тестирование моделей (sample requests)
- Мониторинг использования (количество запросов, latency, ошибки)
- A/B тестирование версий

**Компоненты:**
- Список зарегистрированных моделей
- Форма регистрации/редактирования
- Метрики производительности моделей
- История версий

### 6. Incidents (Инциденты)

**Путь:** `/incidents`

**Компоненты:**
- `IncidentTimeline` — таймлайн инцидента с событиями и действиями
- `IncidentActions` — панель действий SRE (acknowledge, resolve, escalate)

**Режим инцидента:**
- Переключение в режим инцидента из top-bar
- Контекстная панель с быстрыми действиями
- Создание post-mortem отчетов
- Интеграция с системой алертов

### 7. Settings (Настройки системы)

**Путь:** `/settings`

**Компоненты:**
- `FeatureFlagList` — управление feature flags (включение/выключение функций)
- `GlobalSettingsForm` — системные настройки (таймауты, лимиты, интеграции)

**Настройки:**
- Feature flags с возможностью A/B тестирования
- Глобальные параметры системы
- Настройки интеграций
- Параметры безопасности

### 8. Billing (Биллинг и тарифы)

**Путь:** `/billing`

**Функциональность:**
- Управление подписками организаций
- Просмотр истории платежей
- Настройка тарифных планов
- Аналитика доходов (MRR, ARR, churn rate)
- Управление промокодами и скидками

## UX паттерны

### Навигация

- **Sidebar:** фиксированная боковая панель с возможностью сворачивания
- **Breadcrumbs:** в top-bar для понимания текущего раздела
- **Context Panel:** выдвижная панель справа для контекстных действий

### Интерактивность

- **Горячие клавиши:** `Shift+/` — список всех shortcuts
- **Real-time обновления:** автоматическое обновление данных через WebSocket
- **Оптимистичные обновления:** UI обновляется сразу, затем синхронизируется с сервером

### Обратная связь

- **Статусные индикаторы:** цветовые бейджи для статусов (success, warning, error, info)
- **Загрузочные состояния:** скелетоны и спиннеры при загрузке данных
- **Уведомления:** toast-уведомления для успешных операций и ошибок

### Адаптивность

- **Responsive grid:** адаптивная сетка для разных размеров экранов
- **Mobile-first:** оптимизация для мобильных устройств (collapsed sidebar)
- **Breakpoints:** `max-width: 1440px` для переключения на одноколоночный layout

## Архитектура состояния

**Pinia Stores:**
- `system` — системное здоровье, метрики
- `users` — пользователи, роли, права
- `analytics` — аналитические данные, KPI
- `incidents` — инциденты, таймлайны
- `billing` — подписки, платежи
- `settings` — настройки, feature flags
- `ai-models` — AI модели и их метрики

**Realtime каналы:**
- `system.health` — обновления здоровья системы
- `alerts.critical` — критические алерты
- `analytics.metrics` — метрики аналитики
- `incidents.updates` — обновления инцидентов

## Горячие клавиши

- `Shift+H` — обновить системный дашборд
- `Shift+E` — экспорт дашборда
- `Shift+/` — показать все горячие клавиши
- `Ctrl+K` — глобальный поиск (планируется)
