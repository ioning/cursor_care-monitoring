# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–µ–º–∞ –∑–≤–æ–Ω–∫–æ–≤ –æ—Ç –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞

## –î–∞—Ç–∞: 2025-12-25

## –û–±–∑–æ—Ä

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏–µ–º–∞ –∑–≤–æ–Ω–∫–æ–≤ –æ—Ç –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞ –≤ –º–æ–±–∏–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –ø–æ–¥–æ–ø–µ—á–Ω–æ–≥–æ —Å –≤—ã–≤–æ–¥–æ–º –Ω–∞ –≥—Ä–æ–º–∫—É—é —Å–≤—è–∑—å –Ω–∞ –±—Ä–∞—Å–ª–µ—Ç–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ.

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–≤–æ–Ω–∫–æ–≤

#### SettingsSlice (`src/store/slices/settingsSlice.ts`)
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π –≤—ã–∑–æ–≤ –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ** (`priorityCallOverlay`)
  - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `true`
  - –ó–≤–æ–Ω–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–æ–≤–µ—Ä—Ö –≤—Å–µ—Ö –æ–∫–æ–Ω
  - –ù–µ–ª—å–∑—è –∑–∞–∫—Ä—ã—Ç—å —Å–ª—É—á–∞–π–Ω–æ

- **–ì—Ä–æ–º–∫–∞—è —Å–≤—è–∑—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** (`defaultSpeakerMode`)
  - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `true`
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç—Å—è –ø—Ä–∏ –ø—Ä–∏–µ–º–µ –∑–≤–æ–Ω–∫–∞
  - –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±—Ä–∞—Å–ª–µ—Ç –¥–ª—è –≥—Ä–æ–º–∫–æ–π —Å–≤—è–∑–∏

- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Bluetooth** (`useBluetoothForCalls`)
  - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `true`
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Bluetooth –≥–∞—Ä–Ω–∏—Ç—É—Ä—ã, –µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞
  - –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É Bluetooth –∏ –≥—Ä–æ–º–∫–æ–π —Å–≤—è–∑—å—é

- **–í–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ –∑–≤–æ–Ω–∫–µ** (`callVibration`)
  - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `true`
  - –í–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ –≤—Ö–æ–¥—è—â–µ–º –∑–≤–æ–Ω–∫–µ

- **–ó–≤—É–∫ –ø—Ä–∏ –∑–≤–æ–Ω–∫–µ** (`callSound`)
  - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `true`
  - –ó–≤—É–∫–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–≤–µ—Ç** (`autoAnswerCalls`)
  - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `false`
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–µ–º –∑–≤–æ–Ω–∫–∞ —á–µ—Ä–µ–∑ –∑–∞–¥–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è

- **–ó–∞–¥–µ—Ä–∂–∫–∞ –∞–≤—Ç–æ–æ—Ç–≤–µ—Ç–∞** (`autoAnswerDelay`)
  - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `4` —Å–µ–∫—É–Ω–¥—ã
  - –í—Ä–µ–º—è –¥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–µ–º–∞ –∑–≤–æ–Ω–∫–∞

### 2. IncomingCallScreen

#### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Ö–æ–¥—è—â–µ–≥–æ –∑–≤–æ–Ω–∫–∞
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–∑ Redux store
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ–π —Å–≤—è–∑–∏ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Bluetooth –≥–∞—Ä–Ω–∏—Ç—É—Ä
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π —Ä–µ–∂–∏–º (–ø–æ–≤–µ—Ä—Ö –≤—Å–µ—Ö –æ–∫–æ–Ω)
- ‚úÖ –í–∏–±—Ä–∞—Ü–∏—è –∏ –∑–≤—É–∫ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω—ã –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö)
- ‚úÖ –ê–≤—Ç–æ–æ—Ç–≤–µ—Ç (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö)

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:
```typescript
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
const settings = useSelector((state: RootState) => state.settings);

// –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π –≤—ã–∑–æ–≤
if (settings.priorityCallOverlay) {
  InCallManager.setKeepScreenOn(true);
  InCallManager.start({ media: 'audio' });
}

// –ì—Ä–æ–º–∫–∞—è —Å–≤—è–∑—å
if (settings.defaultSpeakerMode) {
  await AudioService.enableSpeaker();
}

// Bluetooth
if (settings.useBluetoothForCalls) {
  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Bluetooth, –µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω
}
```

### 3. AudioService

#### –£–ª—É—á—à–µ–Ω–∏—è:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Bluetooth, –µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω
- ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É Bluetooth –∏ –≥—Ä–æ–º–∫–æ–π —Å–≤—è–∑—å—é
- ‚úÖ `setForceSpeakerphoneOn(true)` –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –≥—Ä–æ–º–∫–æ–π —Å–≤—è–∑–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±—Ä–∞—Å–ª–µ—Ç–∞ —á–µ—Ä–µ–∑ –≥—Ä–æ–º–∫—É—é —Å–≤—è–∑—å

#### –ú–µ—Ç–æ–¥—ã:
```typescript
// –í–∫–ª—é—á–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ–π —Å–≤—è–∑–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Bluetooth
await AudioService.enableSpeaker();
// InCallManager –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Bluetooth, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω

// –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ–π —Å–≤—è–∑–∏
await AudioService.disableSpeaker();
```

### 4. NotificationService

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:
- ‚úÖ –ö–∞–Ω–∞–ª `care-monitoring-calls` —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º (`importance: 5`)
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ–≤–µ—Ä—Ö –≤—Å–µ—Ö –æ–∫–æ–Ω
- ‚úÖ `ongoing: true` - –Ω–µ–ª—å–∑—è —Å–º–∞—Ö–Ω—É—Ç—å
- ‚úÖ `autoCancel: false` - –Ω–µ —É–¥–∞–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ `priority: 'max'` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

### 5. AndroidManifest

#### –†–∞–∑—Ä–µ—à–µ–Ω–∏—è:
- ‚úÖ `SYSTEM_ALERT_WINDOW` - –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–≤–µ—Ä—Ö –≤—Å–µ—Ö –æ–∫–æ–Ω
- ‚úÖ `USE_FULL_SCREEN_INTENT` - –¥–ª—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ `MODIFY_AUDIO_SETTINGS` - –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞—É–¥–∏–æ
- ‚úÖ `RECORD_AUDIO` - –¥–ª—è –∑–∞–ø–∏—Å–∏ –∑–≤—É–∫–∞

### 6. –ù–∞–≤–∏–≥–∞—Ü–∏—è

#### IncomingCall —ç–∫—Ä–∞–Ω:
- ‚úÖ `presentation: 'fullScreenModal'` - –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
- ‚úÖ `gestureEnabled: false` - –Ω–µ–ª—å–∑—è –∑–∞–∫—Ä—ã—Ç—å —Å–≤–∞–π–ø–æ–º
- ‚úÖ `animation: 'slide_from_bottom'` - –∞–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è

## üìä –ü–æ—Ç–æ–∫ –ø—Ä–∏–µ–º–∞ –∑–≤–æ–Ω–∫–∞

```
1. Push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞
   ‚Üì
2. NotificationService.showCallNotification()
   ‚Üì
3. –ù–∞–≤–∏–≥–∞—Ü–∏—è –∫ IncomingCallScreen
   ‚Üì
4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫:
   - priorityCallOverlay ‚Üí —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
   - callVibration ‚Üí –≤–∏–±—Ä–∞—Ü–∏—è
   - callSound ‚Üí –∑–≤—É–∫
   ‚Üì
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–û—Ç–≤–µ—Ç–∏—Ç—å" –∏–ª–∏ –∞–≤—Ç–æ–æ—Ç–≤–µ—Ç
   ‚Üì
6. handleAnswer():
   - AudioService.initialize()
   - –ï—Å–ª–∏ defaultSpeakerMode ‚Üí AudioService.enableSpeaker()
   - –ï—Å–ª–∏ useBluetoothForCalls ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ Bluetooth
   - CallService.accept(callId)
   ‚Üì
7. –ó–≤–æ–Ω–æ–∫ –∞–∫—Ç–∏–≤–µ–Ω:
   - –ì—Ä–æ–º–∫–∞—è —Å–≤—è–∑—å –≤–∫–ª—é—á–µ–Ω–∞ (–¥–ª—è –±—Ä–∞—Å–ª–µ—Ç–∞)
   - –ò–ª–∏ Bluetooth –≥–∞—Ä–Ω–∏—Ç—É—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
   - –ó–≤—É–∫ –≤—ã–≤–æ–¥–∏—Ç—Å—è –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

### –≠–∫—Ä–∞–Ω –Ω–∞—Å—Ç—Ä–æ–µ–∫ (SettingsScreen)

–î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–µ–∫—Ü–∏—è "–ó–≤–æ–Ω–∫–∏" —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:

1. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π –≤—ã–∑–æ–≤ –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ**
   - –í–∫–ª—é—á–∞–µ—Ç/–≤—ã–∫–ª—é—á–∞–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–≤–æ–Ω–∫–æ–≤ –ø–æ–≤–µ—Ä—Ö –≤—Å–µ—Ö –æ–∫–æ–Ω
   - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω–æ

2. **–ì—Ä–æ–º–∫–∞—è —Å–≤—è–∑—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç –≥—Ä–æ–º–∫—É—é —Å–≤—è–∑—å –ø—Ä–∏ –ø—Ä–∏–µ–º–µ –∑–≤–æ–Ω–∫–∞
   - –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±—Ä–∞—Å–ª–µ—Ç–∞
   - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω–æ

3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Bluetooth**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Bluetooth –≥–∞—Ä–Ω–∏—Ç—É—Ä—É, –µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É Bluetooth –∏ –≥—Ä–æ–º–∫–æ–π —Å–≤—è–∑—å—é
   - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω–æ

4. **–í–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ –∑–≤–æ–Ω–∫–µ**
   - –í–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ –≤—Ö–æ–¥—è—â–µ–º –∑–≤–æ–Ω–∫–µ
   - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω–æ

5. **–ó–≤—É–∫ –ø—Ä–∏ –∑–≤–æ–Ω–∫–µ**
   - –ó–≤—É–∫–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
   - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω–æ

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±—Ä–∞—Å–ª–µ—Ç–∞

### –ì—Ä–æ–º–∫–∞—è —Å–≤—è–∑—å –Ω–∞ –±—Ä–∞—Å–ª–µ—Ç–µ

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ**
   - –ü—Ä–∏ –ø—Ä–∏–µ–º–µ –∑–≤–æ–Ω–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≥—Ä–æ–º–∫–∞—è —Å–≤—è–∑—å
   - –ó–≤—É–∫ –≤—ã–≤–æ–¥–∏—Ç—Å—è —á–µ—Ä–µ–∑ –¥–∏–Ω–∞–º–∏–∫–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
   - –ë—Ä–∞—Å–ª–µ—Ç –ø–æ–ª—É—á–∞–µ—Ç –∑–≤—É–∫ —á–µ—Ä–µ–∑ Bluetooth –∏–ª–∏ –ø—Ä–æ–≤–æ–¥–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

2. **Bluetooth –≥–∞—Ä–Ω–∏—Ç—É—Ä–∞**
   - –ï—Å–ª–∏ Bluetooth –≥–∞—Ä–Ω–∏—Ç—É—Ä–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–Ω–∞
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –≥–∞—Ä–Ω–∏—Ç—É—Ä–æ–π –∏ –≥—Ä–æ–º–∫–æ–π —Å–≤—è–∑—å—é
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Bluetooth 5.0+

3. **–†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤—ã–≤–æ–¥–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
   - –í–æ –≤—Ä–µ–º—è –∑–≤–æ–Ω–∫–∞ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏

## üì± –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π –≤—ã–∑–æ–≤ –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

1. **Android**
   - –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ `SYSTEM_ALERT_WINDOW`
   - –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ `USE_FULL_SCREEN_INTENT`
   - –ö–∞–Ω–∞–ª —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å `importance: 5`
   - `InCallManager.setKeepScreenOn(true)`
   - –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π –º–æ–¥–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω

2. **iOS**
   - –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π –º–æ–¥–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω
   - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
   - –ù–µ–ª—å–∑—è –∑–∞–∫—Ä—ã—Ç—å —Å–≤–∞–π–ø–æ–º

### –ü–æ–≤–µ–¥–µ–Ω–∏–µ

- ‚úÖ –ó–≤–æ–Ω–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø–æ–≤–µ—Ä—Ö –≤—Å–µ—Ö –æ–∫–æ–Ω
- ‚úÖ –ù–µ–ª—å–∑—è —Å–ª—É—á–∞–π–Ω–æ –∑–∞–∫—Ä—ã—Ç—å
- ‚úÖ –≠–∫—Ä–∞–Ω –æ—Å—Ç–∞–µ—Ç—Å—è –≤–∫–ª—é—á–µ–Ω–Ω—ã–º –≤–æ –≤—Ä–µ–º—è –∑–≤–æ–Ω–∫–∞
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ –ó–≤—É–∫ –∏ –≤–∏–±—Ä–∞—Ü–∏—è –¥–∞–∂–µ –≤ –±–µ–∑–∑–≤—É—á–Ω–æ–º —Ä–µ–∂–∏–º–µ

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±—Ä–∞—Å–ª–µ—Ç–æ–º

### –ß–µ—Ä–µ–∑ Bluetooth

1. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ**
   - –ë—Ä–∞—Å–ª–µ—Ç –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ Bluetooth
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏ –∑–≤–æ–Ω–∫–µ

2. **–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∞—É–¥–∏–æ**
   - InCallManager –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Bluetooth, –µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω
   - –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É Bluetooth –∏ –≥—Ä–æ–º–∫–æ–π —Å–≤—è–∑—å—é
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ HFP (Hands-Free Profile)

3. **–ì—Ä–æ–º–∫–∞—è —Å–≤—è–∑—å**
   - –ï—Å–ª–∏ Bluetooth –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥—Ä–æ–º–∫–∞—è —Å–≤—è–∑—å
   - –ó–≤—É–∫ –≤—ã–≤–æ–¥–∏—Ç—Å—è —á–µ—Ä–µ–∑ –¥–∏–Ω–∞–º–∏–∫–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
   - –ë—Ä–∞—Å–ª–µ—Ç –ø–æ–ª—É—á–∞–µ—Ç –∑–≤—É–∫ —á–µ—Ä–µ–∑ –ø—Ä–æ–≤–æ–¥–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

```typescript
{
  priorityCallOverlay: true,      // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π –≤—ã–∑–æ–≤ –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ
  defaultSpeakerMode: true,        // –ì—Ä–æ–º–∫–∞—è —Å–≤—è–∑—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  useBluetoothForCalls: true,     // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Bluetooth
  callVibration: true,            // –í–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ –∑–≤–æ–Ω–∫–µ
  callSound: true,                // –ó–≤—É–∫ –ø—Ä–∏ –∑–≤–æ–Ω–∫–µ
  autoAnswerCalls: false,         // –ê–≤—Ç–æ–æ—Ç–≤–µ—Ç (–≤—ã–∫–ª—é—á–µ–Ω)
  autoAnswerDelay: 4,             // –ó–∞–¥–µ—Ä–∂–∫–∞ –∞–≤—Ç–æ–æ—Ç–≤–µ—Ç–∞ (4 —Å–µ–∫)
}
```

## üìù –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `AsyncStorage`:
- –ö–ª—é—á: `@care_monitoring:settings`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. ‚úÖ –ü—Ä–∏–µ–º –∑–≤–æ–Ω–∫–æ–≤ –æ—Ç –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞
2. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ–π —Å–≤—è–∑–∏
3. ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Bluetooth –≥–∞—Ä–Ω–∏—Ç—É—Ä
4. ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π –≤—ã–∑–æ–≤ –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ
5. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
6. ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
7. ‚úÖ –í–∏–±—Ä–∞—Ü–∏—è –∏ –∑–≤—É–∫
8. ‚úÖ –ê–≤—Ç–æ–æ—Ç–≤–µ—Ç (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω)

### –ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

1. ‚ö†Ô∏è –†–∞–±–æ—Ç–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º –±—Ä–∞—Å–ª–µ—Ç–æ–º (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
2. ‚ö†Ô∏è –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ SYSTEM_ALERT_WINDOW (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ Android 6.0+)
3. ‚ö†Ô∏è –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ USE_FULL_SCREEN_INTENT (—Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞ Android 10+)

## üîê –†–∞–∑—Ä–µ—à–µ–Ω–∏—è

### Android

–î–ª—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è:

1. **SYSTEM_ALERT_WINDOW** (Android 6.0+)
   - –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω —Ä–∞–∑—Ä–µ—à–∏—Ç—å –≤—Ä—É—á–Ω—É—é –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö

2. **USE_FULL_SCREEN_INTENT** (Android 10+)
   - –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   - –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

```typescript
import { PermissionsAndroid, Platform } from 'react-native';
import { requestOverlayPermission } from 'react-native-permissions';

// –ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–≤–µ—Ä—Ö –≤—Å–µ—Ö –æ–∫–æ–Ω
if (Platform.OS === 'android') {
  const granted = await requestOverlayPermission();
  if (!granted) {
    // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
  }
}
```

## üìÑ –§–∞–π–ª—ã

- `mobile/ward-app/src/store/slices/settingsSlice.ts` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏
- `mobile/ward-app/src/screens/SettingsScreen.tsx` - –≠–∫—Ä–∞–Ω –Ω–∞—Å—Ç—Ä–æ–µ–∫
- `mobile/ward-app/src/screens/IncomingCallScreen.tsx` - –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥—è—â–µ–≥–æ –∑–≤–æ–Ω–∫–∞
- `mobile/ward-app/src/services/AudioService.ts` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—É–¥–∏–æ
- `mobile/ward-app/src/services/NotificationService.ts` - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `mobile/ward-app/src/navigation/AppNavigator.tsx` - –ù–∞–≤–∏–≥–∞—Ü–∏—è
- `mobile/ward-app/android/app/src/main/AndroidManifest.xml` - –†–∞–∑—Ä–µ—à–µ–Ω–∏—è

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-12-25

